graph TD
    A[Receive Syslog Message] --> B[Queue Message]
    B --> C{Process Message}
    C --> D[Parse Message]
    D --> E{Determine Message Type}
    E --> F[Failed Attempts]
    E --> G[TACACS Accounting]
    E --> H[Passed Authentications]
    F --> I[Insert into FTA/FWA/FLA]
    G --> J[Insert into TCA]
    H --> K[Insert into PWA/PLA]
    I --> L[Add to Batch]
    J --> L
    K --> L
    L --> M{Batch Full or Timer Expired?}
    M -->|Yes| N[Flush Batch to Database]
    M -->|No| O[Wait for More Messages]
    O --> C
